import { Button, VerticalBox, LineEdit, StandardTableView, CheckBox } from "std-widgets.slint";

export global TableViewAdapter  {
    in property <[[StandardListViewItem]]> row_data: [
    ];
}

export component AppWindow inherits Window {
    title: "Credit calculator";
    in property<string> credit_overview: "";
    property <bool> monthly_rate: true;
    callback request-credit-plan-rates(float, float, float, float);
    callback request-credit-plan-annuity(float, float, float, float);
    VerticalBox {
        loan := LineEdit {
            input-type: decimal;
            placeholder-text: "Credit Loan in €";
            font-size: 20pt;
        }
        annual_interest_rate := LineEdit {
            input-type: decimal;
            placeholder-text: "Annual Interest Rate in %";
            font-size: 20pt;
        }
        monthly_rate_checkbox := CheckBox {
            text: "Provide Annuity";
            checked: monthly_rate;
            toggled => {monthly_rate = !monthly_rate}
        }
        annual_pay_off_rate := LineEdit {
            input-type: decimal;
            placeholder-text: "Annual pay off rate in %";
            font-size: 20pt;
            enabled: !monthly_rate;
        }
        annuity := LineEdit{
            input-type: decimal;
            placeholder-text: "Monthly annuity in €";
            font-size: 20pt;
            enabled: monthly_rate;
        }
        annual_unscheduled_amortization := LineEdit{
            input-type: decimal;
            placeholder-text: "Annual unscheduled amortization in €";
            font-size: 20pt;
        }
        Button {
            text: "Calculate Credit Plan";
            clicked => {
                if monthly_rate {
                    root.request-credit-plan-annuity(loan.text.to-float(), annual-interest-rate.text.to-float(), annuity.text.to-float(), annual-unscheduled-amortization.text.to-float());
                } else {
                    root.request-credit-plan-rates(loan.text.to-float(), annual-interest-rate.text.to-float(), annual-pay-off-rate.text.to-float(), annual-unscheduled-amortization.text.to-float());
                }
            }
        }
        Text {
            text: root.credit_overview;
            font-size: 20pt;
        }
       
        annuity_table := StandardTableView {
            width: 800px;
            columns: [
                { title: "Payment date" },
                { title: "Annuity" },
                { title: "Interest" },
                { title: "Amortization" },
                { title: "Unscheduled Amortization" },
                { title: "Residual dept" },
            ];
            rows: TableViewAdapter.row_data;
        }
    }
}
